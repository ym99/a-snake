<html>
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="cache-control" content="max-age=0"/>
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
        <meta http-equiv="pragma" content="no-cache" />
        <meta name="viewport" content="width=350">

        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

        <style>
        body {
            margin: 0;
        }

        #main {
            border-spacing: 0; 
            border-collapse: separate;
            
        }

        #main td{
            border: solid 1px #ffffff;
            width: 10px;
            height: 10px;
        
            border-radius: 5px;
        }

        #main td.snake-head {
            border: solid 1px #02a302;
        }
        
        #main td.snake-body{
            border: solid 1px #015e01;
        }     
        
        #up, #down, #left, #right, #slower, #faster {
            position: absolute;
            font-size: 25vh;
            text-align: center;
            opacity: 0.1;
        }
        
        #up.clicked, #down.clicked, #left.clicked, #right.clicked {
            opacity: 0.3;
        }

        #left i, #right i {
            transform: translateY(50%);
        }
        
       </style>

        <script>
            document.addEventListener("DOMContentLoaded", (event) => {
                function fillTable(){
                    var maxCells = Math.floor((window.innerWidth - 2) / 10);
                    var maxRows = Math.floor((window.innerHeight - 2) / 10);
                
                    var r = 0;
                    while(r < maxRows) {
                        var row = table.insertRow(table.rows.length-1);
                        var c = 0;
                        while (c < maxCells){
                            var cell = row.insertCell(row.cells.length-1);
                        
                            c = c + 1;
                        }
                        r = r + 1;  
                    }
                }

                function onUp() {
                    delta = {
                        x: 0,
                        y: -1
                    };
                    clicked("up");
                }

                function onDown() {
                    delta = {
                        x:0,
                        y:1
                    };
                    clicked("down");
                }

                function onLeft() {
                    delta = {
                        x:-1,
                        y:0
                    };
                    clicked("left");
                }

                function onRight() {
                    delta = {
                        x:1,
                        y:0
                    };
                    clicked("right");
                }
            
                function createButtons() {
                    var up = document.getElementById("up");
                    up.style.left = window.innerWidth/4;
                    up.style.top = 0;
                    up.style.width = window.innerWidth/2;
                    up.style.height = window.innerHeight/4; 
                    up.addEventListener("click", onUp);

                    var down = document.getElementById("down");
                    down.style.left = window.innerWidth/4;
                    down.style.top = window.innerHeight*3/4 ;
                    down.style.width = window.innerWidth/2;
                    down.style.height = window.innerHeight/4;
                    down.addEventListener("click", onDown);
                    
                    var left = document.getElementById("left");
                    left.style.left = 0;
                    left.style.top = window.innerHeight/4 ;
                    left.style.width = window.innerWidth/4;
                    left.style.height = window.innerHeight/2;
                    left.addEventListener("click", onLeft);

                    var right = document.getElementById("right");
                    right.style.left = window.innerWidth*3/4;
                    right.style.top = window.innerHeight/4 ;
                    right.style.width = window.innerWidth/4;
                    right.style.height = window.innerHeight/2;
                    right.addEventListener("click", onRight);

                    var slower = document.getElementById("slower");
                    slower.style.left = window.innerWidth*3/4;
                    slower.style.top = window.innerHeight*3/4;
                    slower.style.width = window.innerWidth/8;
                    slower.style.height = window.innerHeight/4;

                    var faster = document.getElementById("faster");
                    faster.style.left = window.innerWidth*7/8;
                    faster.style.top = window.innerHeight*3/4;
                    faster.style.width = window.innerWidth/8;
                    faster.style.height = window.innerHeight/4;

                    document.body.addEventListener("keydown", (e) => {
                        console.info(1);
                        e = e || window.event;
                        if (e.keyCode === 37) {
                            onLeft();
                        }
                        if (e.keyCode === 38) {
                            onUp();
                        }
                        if (e.keyCode === 39) {
                            onRight();
                        }
                        if (e.keyCode === 40) {
                            onDown();
                        }
                    });
                }

                function showSnake(){
                    var snakeHead = snake[0];
                    var table = document.getElementById("main");
                    var row = table.rows[ snakeHead.y ];
                    var cell = row.cells[ snakeHead.x ];
                    cell.classList.add("snake-head");
                     
                    var i = 1;
                    while (i<snake.length){
                        var snakeBody = snake[i];
                        var row = table.rows[ snakeBody.y ];
                        var cell = row.cells[ snakeBody.x ];
                        cell.classList.add("snake-body");
                        i = i + 1;
                    }    
                }
 
                function hideSnake(){
                    var snakeHead = snake[0];
                    var table = document.getElementById("main");
                    var row = table.rows[ snakeHead.y ];
                    var cell = row.cells[ snakeHead.x ];
                    cell.classList.remove("snake-head");
                     
                    var i = 1;
                    while (i<snake.length){
                        var snakeBody = snake[i];
                        var row = table.rows[ snakeBody.y ];
                        var cell = row.cells[ snakeBody.x ];
                        cell.classList.remove("snake-body");
                        i = i + 1;
                    }    
                }

                function clicked (id){
                    document.getElementById(id).classList.add("clicked");
                    window.setTimeout(() => document.getElementById(id).classList.remove("clicked"), 50);
                }
                
                var table = document.getElementById("main");

                var snake = [];
                snake.push({
                    x: 10, 
                    y: 10
                });
                /*snake.push({
                    x: 9,
                    y: 10
                });
                snake.push({
                    x: 8,
                    y: 10
                });*/

                var delta = {
                    x:1,
                    y:0,
                }

                fillTable();
                createButtons(); 
                showSnake();
                

                window.setInterval(() => {
                    hideSnake();
                 
                    var snakeHead = snake[0];
                    snake[0] = {
                        x: snakeHead.x + delta.x,
                        y: snakeHead.y + delta.y    
                    };

                    if(snake[0].x < 0){
                        snake[0].x = table.rows[0].cells.length-1;
                    }

                    if(snake[0].y < 0){
                        snake[0].y = table.rows.length-1;
                    }

                    if(snake[0].x >= table.rows[0].cells.length){
                        snake[0].x = 0;
                    }
                    
                    if(snake[0].y >= table.rows.length){
                        snake[0].y = 0;
                    }
                    
                    showSnake();
                }, 500)
            });
        </script>
    </head>
    <body>
            
        <table id="main"></table>
        <div id = "up">
            <i class="fa fa-chevron-circle-up"></i>
        </div>
        <div id = "down"> 
            <i class="fa fa-chevron-circle-down"></i>
        </div> 
        <div id = "left"> 
            <i class="fa fa-chevron-circle-left"></i>
        </div>
        <div id = "right"> 
            <i class="fa fa-chevron-circle-right"></i>
        </div>

        <dv id = "slower">
            <i class="fa fa-minus-circle"></i>
        </dv>

        <dv id = "faster">
            <i class="fa fa-plus-circle"></i>
        </dv>
        
    </body>

</html>